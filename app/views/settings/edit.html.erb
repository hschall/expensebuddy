<% if flash[:alert] %>
  <div class="alert alert-warning"><%= flash[:alert] %></div>
<% end %>


<div class="container mt-4" style="max-width: 720px;">
  <h3 class="text-center mb-4">Configuraci√≥n del Sistema</h3>

  <%= form_with(model: @setting, url: settings_path, method: :patch, local: true) do |form| %>

    <!-- üñºÔ∏è Avatar -->
    <div class="mb-3">
      <label class="form-label fw-bold">Selecciona un avatar</label>
      <div class="d-flex flex-wrap gap-3">
        <% Dir.glob(Rails.root.join("app/assets/images/avatars/*")).each do |path| %>
          <% filename = File.basename(path) %>
          <label style="cursor: pointer;">
            <%= form.radio_button :avatar_filename, filename, checked: @setting.avatar_filename == filename %>
            <%= image_tag "avatars/#{filename}", style: "width: 64px; height: 64px; border-radius: 50%; border: 2px solid #ccc; margin-left: 5px;" %>
          </label>
        <% end %>
      </div>
    </div>

    <!-- üë§ Nombre -->
    <div class="mb-3">
      <%= form.label :nombre, "Nombre" %>
      <%= form.text_field :nombre, class: "form-control", placeholder: "Ej. Andres Manuel" %>
    </div>

    <!-- üõ†Ô∏è Ciclo de Tarjeta -->
    <div class="mb-3">
      <%= form.label :cycle_end_day, "D√≠a de corte de tarjeta", class: "form-label fw-bold" %>
      <%= form.number_field :cycle_end_day, in: 1..31, class: "form-control", required: true %>
      <div class="form-text">Ejemplo: Si tu fecha de corte es el d√≠a 6, escribe <strong>6</strong>.</div>
    </div>

    <div class="mt-3">
      <%= form.submit "Guardar Configuraci√≥n", class: "btn-custom-primary-sm" %>
    </div>

  <% end %>

  <!-- üßπ Opciones de limpieza -->
  <hr class="my-4">

  <div class="d-flex flex-column gap-2">
    <%= button_to "Eliminar todos los registros (Transacciones y Pagos de Saldo)",
      delete_all_records_path,
      method: :delete,
      class: "btn-custom-danger-sm",
      onclick: "return confirm('¬øEst√°s seguro que deseas eliminar TODAS las transacciones y pagos de saldo?')" %>
  </div>
</div>
